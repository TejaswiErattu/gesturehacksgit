<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Muse Educator Pilot - Transform Learning Through Story</title>
    <style>
      /* Muse Brand Colors - Exact Specification */
      :root {
        --muse-indigo: #4B3E91;
        --lavender-mist: #E8E4FB;
        --golden-amber: #FF9159;
        --slate-gray: #5E6070;
        --white: #FFFFFF;
      }

      /* Muse Brand Colors - Exact Specification */
      :root {
        --muse-indigo: #4B3E91;
        --lavender-mist: #E8E4FB;
        --golden-amber: #FF9159;
        --slate-gray: #5E6070;
        --white: #FFFFFF;
      }

      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      /* Respect reduced motion preferences */
      @media (prefers-reduced-motion: reduce) {
        *, *::before, *::after {
          animation-duration: 0.01ms !important;
          animation-iteration-count: 1 !important;
          transition-duration: 0.01ms !important;
        }
      }

      body {
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
        line-height: 1.6;
        color: var(--slate-gray);
        background: linear-gradient(135deg, var(--lavender-mist) 0%, var(--white) 60%);
        min-height: 100vh;
      }

      .container {
        max-width: 1180px;
        margin: 0 auto;
        padding: 0 1.5rem;
      }

      /* Typography */
      h1, h2, h3 {
        color: var(--muse-indigo);
        font-weight: 600;
        line-height: 1.2;
      }

      h1 {
        font-size: clamp(2.5rem, 5vw, 3.5rem);
        font-family: Georgia, 'Times New Roman', serif;
      }

      h2 {
        font-size: clamp(1.75rem, 3vw, 2.25rem);
      }

      h3 {
        font-size: 1.25rem;
      }

      /* Header */
      header {
        position: sticky;
        top: 0;
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(10px);
        border-bottom: 1px solid rgba(75, 62, 145, 0.1);
        z-index: 100;
        transition: box-shadow 0.2s ease;
      }

      header.scrolled {
        box-shadow: 0 2px 20px rgba(0, 0, 0, 0.1);
      }

      .header-content {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 1rem 0;
      }

      .logo {
        font-size: 1.75rem;
        font-weight: bold;
        color: var(--muse-indigo);
        text-decoration: none;
        font-family: Georgia, serif;
      }

      .nav-links {
        display: none;
        gap: 2rem;
        list-style: none;
      }

      .nav-links a {
        color: var(--slate-gray);
        text-decoration: none;
        font-weight: 500;
        transition: color 0.2s ease;
        padding: 0.5rem 0;
        border-bottom: 2px solid transparent;
      }

      .nav-links a:hover,
      .nav-links a:focus {
        color: var(--muse-indigo);
        border-bottom-color: var(--golden-amber);
        outline: none;
      }

      @media (min-width: 768px) {
        .nav-links {
          display: flex;
        }
      }

      /* Hero Section */
      .hero {
        padding: 4rem 0;
        text-align: center;
        background: var(--white);
      }

      .hero h1 {
        margin-bottom: 1.5rem;
      }

      .hero .subtitle {
        font-size: 1.25rem;
        color: var(--slate-gray);
        margin-bottom: 2.5rem;
        max-width: 600px;
        margin-left: auto;
        margin-right: auto;
      }

      .hero-visual {
        width: 100%;
        max-width: 500px;
        height: 280px;
        background: linear-gradient(135deg, var(--muse-indigo), var(--lavender-mist));
        border-radius: 20px;
        margin: 2rem auto;
        display: flex;
        align-items: center;
        justify-content: center;
        box-shadow: 0 10px 30px rgba(75, 62, 145, 0.2);
        overflow: hidden;
        position: relative;
      }

      .cta-primary {
        display: inline-block;
        background: var(--golden-amber);
        color: var(--white);
        padding: 1rem 2.5rem;
        border-radius: 50px;
        text-decoration: none;
        font-weight: 600;
        font-size: 1.1rem;
        transition: all 0.3s ease;
        box-shadow: 0 4px 15px rgba(255, 145, 89, 0.3);
        border: none;
        cursor: pointer;
      }

      .cta-primary:hover,
      .cta-primary:focus {
        transform: translateY(-2px);
        box-shadow: 0 6px 20px rgba(255, 145, 89, 0.4);
        outline: 2px solid var(--golden-amber);
        outline-offset: 2px;
      }

      /* Sections */
      section {
        padding: 4rem 0;
      }

      .section-title {
        text-align: center;
        margin-bottom: 3rem;
        color: var(--muse-indigo);
      }

      /* How it Works */
      .features-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
        gap: 2rem;
        margin-top: 3rem;
      }

      .feature-card {
        background: var(--white);
        padding: 2rem;
        border-radius: 16px;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
        transition: transform 0.2s ease, box-shadow 0.2s ease;
        border: 1px solid rgba(75, 62, 145, 0.1);
      }

      .feature-card:hover,
      .feature-card:focus-within {
        transform: translateY(-4px);
        box-shadow: 0 8px 25px rgba(0, 0, 0, 0.12);
      }

      .feature-icon {
        font-size: 2.5rem;
        margin-bottom: 1rem;
        display: block;
      }

      .feature-card h3 {
        margin-bottom: 1rem;
        color: var(--muse-indigo);
      }

      .feature-card p {
        color: var(--slate-gray);
        line-height: 1.6;
      }

      /* Story Spark Live Demo */
      .demo-section {
        background: linear-gradient(135deg, var(--lavender-mist) 0%, var(--white) 100%);
        padding: 4rem 0;
      }

      .demo-container {
        max-width: 700px;
        margin: 0 auto;
        background: var(--white);
        padding: 2.5rem;
        border-radius: 20px;
        box-shadow: 0 8px 30px rgba(0, 0, 0, 0.1);
      }

      .demo-inputs {
        display: grid;
        grid-template-columns: 1fr;
        gap: 1.5rem;
        margin-bottom: 2rem;
      }

      .input-group {
        display: flex;
        flex-direction: column;
        gap: 0.5rem;
      }

      .input-group label {
        font-weight: 600;
        color: var(--muse-indigo);
      }

      .demo-inputs input,
      .demo-inputs select {
        padding: 0.75rem 1rem;
        border: 2px solid var(--lavender-mist);
        border-radius: 8px;
        font-size: 1rem;
        transition: border-color 0.2s ease;
        background: var(--white);
      }

      .demo-inputs input:focus,
      .demo-inputs select:focus {
        outline: none;
        border-color: var(--muse-indigo);
        box-shadow: 0 0 0 3px rgba(75, 62, 145, 0.1);
      }

      .demo-button {
        background: var(--muse-indigo);
        color: var(--white);
        border: none;
        padding: 1rem 2rem;
        border-radius: 8px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.2s ease;
        width: 100%;
      }

      .demo-button:hover,
      .demo-button:focus {
        background: #3a2f7a;
        transform: translateY(-1px);
        outline: 2px solid var(--muse-indigo);
        outline-offset: 2px;
      }

      .demo-output {
        margin-top: 2rem;
        padding: 2rem;
        background: linear-gradient(135deg, var(--lavender-mist), var(--white));
        border-radius: 12px;
        border-left: 4px solid var(--golden-amber);
        display: none;
      }

      .demo-output.show {
        display: block;
        animation: fadeIn 0.3s ease;
      }

      /* Loading and typing visuals */
      .loading-overlay {
        display: none;
        align-items: center;
        justify-content: center;
        position: absolute;
        inset: 0;
        background: rgba(255,255,255,0.85);
        border-radius: 12px;
        z-index: 30;
        flex-direction: column;
        gap: 0.5rem;
        padding: 1rem 2rem;
      }

      .loading-overlay.show {
        display: flex;
        animation: fadeIn 0.25s ease;
      }

      .loader-ring {
        width: 48px;
        height: 48px;
        border-radius: 50%;
        border: 5px solid rgba(75,62,145,0.15);
        border-top-color: var(--muse-indigo);
        animation: spin 1s linear infinite;
      }

      @keyframes spin {
        to { transform: rotate(360deg); }
      }

      .typing { white-space: pre-wrap; }
      .cursor {
        display: inline-block;
        width: 8px;
        height: 1em;
        background: var(--muse-indigo);
        vertical-align: text-bottom;
        margin-left: 3px;
        animation: blink 1s steps(2,start) infinite;
      }

      @keyframes blink { to { visibility: hidden; } }


      @keyframes fadeIn {
        from { opacity: 0; transform: translateY(10px); }
        to { opacity: 1; transform: translateY(0); }
      }

      .output-section {
        margin-bottom: 1.5rem;
      }

      .output-section h4 {
        color: var(--muse-indigo);
        margin-bottom: 0.5rem;
        font-size: 1rem;
      }

      .output-section p {
        color: var(--slate-gray);
        font-style: italic;
      }

      .output-actions {
        display: flex;
        gap: 1rem;
        margin-top: 1.5rem;
        flex-wrap: wrap;
      }

      .btn-secondary {
        background: var(--white);
        color: var(--muse-indigo);
        border: 2px solid var(--muse-indigo);
        padding: 0.5rem 1rem;
        border-radius: 8px;
        font-weight: 500;
        cursor: pointer;
        transition: all 0.2s ease;
        text-decoration: none;
        display: inline-block;
      }

      .btn-secondary:hover,
      .btn-secondary:focus {
        background: var(--muse-indigo);
        color: var(--white);
        outline: 2px solid var(--muse-indigo);
        outline-offset: 2px;
      }

      @media (min-width: 768px) {
        .demo-inputs {
          grid-template-columns: 2fr 1fr 1fr;
        }
        .demo-button {
          width: auto;
          align-self: end;
        }
      }

      /* Testimonials */
      .testimonials {
        background: var(--white);
      }

      .quotes-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
        gap: 2rem;
        margin-top: 3rem;
      }

      .quote-card {
        background: var(--white);
        padding: 2rem;
        border-radius: 16px;
        border-left: 4px solid var(--golden-amber);
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
      }

      .quote-text {
        font-style: italic;
        font-size: 1.1rem;
        margin-bottom: 1.5rem;
        color: var(--slate-gray);
      }

      .quote-author {
        font-weight: bold;
        color: var(--muse-indigo);
      }

      .quote-role {
        font-size: 0.9rem;
        color: var(--slate-gray);
      }

      /* Pilot CTA */
      .pilot-cta {
        background: linear-gradient(135deg, var(--muse-indigo) 0%, #3a2f7a 100%);
        color: var(--white);
        text-align: center;
      }

      .pilot-cta p {
        font-size: 1.2rem;
        margin-bottom: 2rem;
        opacity: 0.95;
      }

      .cta-actions {
        display: flex;
        flex-direction: column;
        gap: 1rem;
        align-items: center;
        margin-top: 2rem;
      }

      .accordion-trigger {
        background: none;
        border: none;
        color: var(--white);
        text-decoration: underline;
        cursor: pointer;
        font-size: 1rem;
        opacity: 0.8;
        transition: opacity 0.2s ease;
      }

      .accordion-trigger:hover,
      .accordion-trigger:focus {
        opacity: 1;
        outline: 2px solid var(--white);
        outline-offset: 2px;
      }

      .accordion-content {
        max-height: 0;
        overflow: hidden;
        transition: max-height 0.3s ease;
        margin-top: 1rem;
      }

      .accordion-content.expanded {
        max-height: 400px;
      }

      .sample-prompts {
        background: rgba(255, 255, 255, 0.1);
        padding: 1.5rem;
        border-radius: 12px;
        text-align: left;
        margin-top: 1rem;
      }

      .sample-prompts ul {
        list-style: none;
        padding: 0;
      }

      .sample-prompts li {
        margin-bottom: 1rem;
        padding-left: 1.5rem;
        position: relative;
      }

      .sample-prompts li:before {
        content: "‚Üí";
        position: absolute;
        left: 0;
        color: var(--golden-amber);
        font-weight: bold;
      }

      /* Footer */
      footer {
        background: var(--slate-gray);
        color: var(--white);
        padding: 2rem 0;
        text-align: center;
      }

      .footer-content {
        display: flex;
        flex-direction: column;
        gap: 1rem;
        align-items: center;
      }

      .footer-links {
        display: flex;
        gap: 2rem;
        flex-wrap: wrap;
        justify-content: center;
      }

      .footer-links button {
        background: none;
        border: none;
        color: var(--white);
        text-decoration: underline;
        cursor: pointer;
        font-size: 0.9rem;
        opacity: 0.8;
        transition: opacity 0.2s ease;
      }

      .footer-links button:hover,
      .footer-links button:focus {
        opacity: 1;
        outline: 1px solid var(--white);
        outline-offset: 2px;
      }

      .disclosure {
        max-height: 0;
        overflow: hidden;
        transition: max-height 0.3s ease;
        margin-top: 1rem;
        text-align: left;
        background: rgba(255, 255, 255, 0.1);
        border-radius: 8px;
        padding: 0 1rem;
      }

      .disclosure.expanded {
        max-height: 300px;
        padding: 1rem;
      }

      /* Download Button */
      .download-page {
        position: fixed;
        bottom: 2rem;
        right: 2rem;
        background: var(--golden-amber);
        color: var(--white);
        border: none;
        padding: 1rem;
        border-radius: 50%;
        cursor: pointer;
        box-shadow: 0 4px 15px rgba(255, 145, 89, 0.3);
        transition: all 0.2s ease;
        z-index: 50;
        width: 60px;
        height: 60px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.25rem;
      }

      .download-page:hover,
      .download-page:focus {
        transform: scale(1.1);
        box-shadow: 0 6px 20px rgba(255, 145, 89, 0.4);
        outline: 2px solid var(--golden-amber);
        outline-offset: 2px;
      }

      /* Responsive */
      @media (max-width: 768px) {
        .quotes-grid {
          grid-template-columns: 1fr;
        }
        
        .cta-actions {
          flex-direction: column;
        }
        
        .output-actions {
          flex-direction: column;
        }
        
        .download-page {
          bottom: 1rem;
          right: 1rem;
        }
      }

      /* Focus styles for better accessibility */
      *:focus {
        outline: 2px solid var(--muse-indigo);
        outline-offset: 2px;
      }

      /* Screen reader only text */
      .sr-only {
        position: absolute;
        width: 1px;
        height: 1px;
        padding: 0;
        margin: -1px;
        overflow: hidden;
        clip: rect(0, 0, 0, 0);
        white-space: nowrap;
        border: 0;
      }
    </style>
  </head>
  <body>
    <!-- Header -->
    <header id="header">
      <div class="container">
        <div class="header-content">
          <a href="#" class="logo">Muse</a>
          <nav>
            <ul class="nav-links">
              <li><a href="#why-muse">Why Muse</a></li>
              <li><a href="#how-it-works">How it Works</a></li>
              <li><a href="#pilot">Pilot</a></li>
            </ul>
          </nav>
        </div>
      </div>
    </header>

    <main>
      <!-- Hero Section -->
      <section class="hero">
        <div class="container">
          <h1>Transform Learning<br>Through Story</h1>
          <p class="subtitle">
            When learning feels personal, it lasts. Muse helps educators turn complex ideas into stories students can feel and remember.
          </p>
          <div class="hero-visual">
            <svg width="200" height="150" viewBox="0 0 200 150" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M20 75 Q 50 25, 100 75 T 180 75" stroke="white" stroke-width="3" fill="none" opacity="0.8"/>
              <circle cx="50" cy="50" r="8" fill="white" opacity="0.9"/>
              <circle cx="100" cy="75" r="10" fill="white"/>
              <circle cx="150" cy="100" r="8" fill="white" opacity="0.9"/>
              <path d="M30 100 L70 120 L50 140 Z" fill="white" opacity="0.7"/>
              <rect x="120" y="90" width="30" height="20" rx="4" fill="white" opacity="0.7"/>
            </svg>
          </div>
          <a href="mailto:gesture@uw.edu?subject=Muse%20Educator%20Pilot&body=Name%3A%0ASchool%3A%0ASubject%3A%0AWhy%20I%E2%80%99m%20interested%3A%0A" class="cta-primary">
            Request Early Access
          </a>
        </div>
      </section>

      <!-- Why Muse -->
      <section id="why-muse">
        <div class="container">
          <h2 class="section-title">Why Muse Matters for Educators</h2>
          <p style="text-align: center; font-size: 1.2rem; max-width: 700px; margin: 0 auto; color: var(--slate-gray);">
            Learning sticks when it connects emotionally. Muse transforms abstract concepts into compelling narratives that spark curiosity, foster deeper connections, and create lasting understanding in your classroom.
          </p>
        </div>
      </section>

      <!-- How it Works -->
      <section id="how-it-works">
        <div class="container">
          <h2 class="section-title">How it Works</h2>
          <div class="features-grid">
            <div class="feature-card" tabindex="0">
              <span class="feature-icon">üó∫Ô∏è</span>
              <h3>Story Map Generator</h3>
              <p>Connects ideas visually through narrative pathways that help students see relationships between concepts.</p>
            </div>
            
            <div class="feature-card" tabindex="0">
              <span class="feature-icon">üí°</span>
              <h3>Reflection Prompt Engine</h3>
              <p>Sparks curiosity and metacognition with thoughtful questions that deepen understanding.</p>
            </div>
            
            <div class="feature-card" tabindex="0">
              <span class="feature-icon">üìù</span>
              <h3>Auto-Summary Composer</h3>
              <p>Condenses dense text without losing meaning, making complex ideas accessible to all learners.</p>
            </div>
            
            <div class="feature-card" tabindex="0">
              <span class="feature-icon">üìñ</span>
              <h3>Insight Journal</h3>
              <p>Keeps "aha" moments connected over time, building continuity in the learning journey.</p>
            </div>
            
            <div class="feature-card" tabindex="0">
              <span class="feature-icon">üõ†Ô∏è</span>
              <h3>Lesson Builder</h3>
              <p>Turns insights into discussion plans that encourage discovery and meaningful exploration.</p>
            </div>
          </div>
        </div>
      </section>

      <!-- Story Spark Live Demo -->
      <section class="demo-section">
        <div class="container">
          <h2 class="section-title">Story Spark Live <span style="font-size: 0.7em; color: var(--golden-amber);">(On-Page Demo)</span></h2>
          <div class="demo-container">
            <p style="text-align: center; margin-bottom: 2rem; color: var(--slate-gray);">
              See how Muse transforms any topic into an engaging story spark for your students.
            </p>
            
            <div class="demo-inputs">
              <div class="input-group">
                <label for="topic-input">Topic or Concept:</label>
                <input type="text" id="topic-input" placeholder="e.g., Photosynthesis, The American Revolution, Quadratic Equations" />
              </div>
              
              <div class="input-group">
                <label for="tone-select">Tone:</label>
                <select id="tone-select">
                  <option value="curious">Curious</option>
                  <option value="reflective">Reflective</option>
                  <option value="playful">Playful</option>
                </select>
              </div>
              
              <div class="input-group">
                <label for="grade-select">Grade Level:</label>
                <select id="grade-select">
                  <option value="6-8">6-8</option>
                  <option value="9-12">9-12</option>
                  <option value="college">College</option>
                </select>
              </div>
              
              <button class="demo-button" onclick="generateStorySpark()">Generate Story Spark</button>
            </div>
            
              <div class="demo-output-wrapper" style="position: relative;">
                <div id="demo-loading" class="loading-overlay" aria-hidden="true">
                  <div class="loader-ring" aria-hidden="true"></div>
                  <div style="color:var(--muse-indigo); font-weight:600;">Muse is shaping your story spark‚Ä¶</div>
                  <div style="color:var(--slate-gray); font-size:0.95rem;">This usually takes 2‚Äì3 seconds.</div>
                </div>

                <div id="demo-output" class="demo-output" role="status" aria-live="polite">
              <div class="output-section">
                <h4>Metaphor:</h4>
                <p id="metaphor-output"></p>
              </div>
              
              <div class="output-section">
                <h4>Mini-Story:</h4>
                <p id="story-output"></p>
              </div>
              
              <div class="output-section">
                <h4>Reflection Prompts:</h4>
                <p id="prompts-output"></p>
              </div>
              
              <div class="output-actions">
                <button class="btn-secondary" onclick="copyToClipboard(event)">Copy to Clipboard</button>
                <button class="btn-secondary" onclick="downloadSpark()">Download Spark (.txt)</button>
              </div>
            </div>
          </div>
          </div>
        </div>
      </section>

      <!-- What Educators Say -->
      <section class="testimonials">
        <div class="container">
          <h2 class="section-title">What Educators Say</h2>
          <div class="quotes-grid">
            <div class="quote-card">
              <p class="quote-text">
                "My sophomores stopped memorizing and started connecting the dots. The difference in their understanding is remarkable."
              </p>
              <div class="quote-author">A. Rivera</div>
              <div class="quote-role">HS History</div>
            </div>
            
            <div class="quote-card">
              <p class="quote-text">
                "The reflection prompts changed how my class talks about science. Students ask deeper questions and make connections I never expected."
              </p>
              <div class="quote-author">M. Patel</div>
              <div class="quote-role">Chemistry</div>
            </div>
          </div>
        </div>
      </section>

      <!-- Pilot CTA -->
      <section id="pilot" class="pilot-cta">
        <div class="container">
          <h2>Join the Educator Pilot Program</h2>
          <p>
            Be among the first educators to shape how Muse supports meaningful learning. Your feedback will help us build something truly transformative for classrooms everywhere.
          </p>
          
          <div class="cta-actions">
            <a href="mailto:gesture@uw.edu?subject=Muse%20Educator%20Pilot&body=Name%3A%0ASchool%3A%0ASubject%3A%0AWhy%20I%E2%80%99m%20interested%3A%0A" class="cta-primary">
              Request Early Access
            </a>
            
            <button class="accordion-trigger" onclick="toggleAccordion('sample-prompts')" aria-expanded="false" aria-controls="sample-prompts">
              View Sample Syllabus Prompts
            </button>
            
            <div id="sample-prompts" class="accordion-content">
              <div class="sample-prompts">
                <ul>
                  <li><strong>History:</strong> "If the American Revolution were a story your students were living through, what character would they be and why?"</li>
                  <li><strong>Science:</strong> "How would you explain photosynthesis as a conversation between a plant and the sun?"</li>
                  <li><strong>Math:</strong> "What real-world mystery could your students solve using quadratic equations?"</li>
                </ul>
              </div>
            </div>
          </div>
        </div>
      </section>
    </main>

    <!-- Footer -->
    <footer>
      <div class="container">
        <div class="footer-content">
          <p>&copy; 2025 Muse. Designed for educators who believe in the power of story.</p>
          
          <div class="footer-links">
            <button onclick="toggleDisclosure('accessibility-notes')" aria-expanded="false" aria-controls="accessibility-notes">
              Brand & Accessibility Notes
            </button>
          </div>
          
          <div id="accessibility-notes" class="disclosure">
            <h4>Accessibility & Brand Information</h4>
            <p><strong>Color Contrast:</strong> All text meets WCAG AA standards (4.5:1 for body text, 3:1 for large text)</p>
            <p><strong>Keyboard Navigation:</strong> All interactive elements are keyboard accessible with visible focus indicators</p>
            <p><strong>Screen Readers:</strong> Semantic HTML and ARIA labels ensure compatibility with assistive technologies</p>
            <p><strong>Brand Colors:</strong> Muse Indigo (#4B3E91), Lavender Mist (#E8E4FB), Golden Amber (#FF9159), Slate Gray (#5E6070)</p>
          </div>
        </div>
      </div>
    </footer>

    <!-- Download Page Button -->
    <button class="download-page" onclick="downloadPage()" title="Download this page" aria-label="Download this page as HTML file">
      ‚¨áÔ∏è
    </button>

    <script>
      // Header scroll effect
      window.addEventListener('scroll', function() {
        const header = document.getElementById('header');
        if (window.scrollY > 50) {
          header.classList.add('scrolled');
        } else {
          header.classList.remove('scrolled');
        }
      });

      // Story Spark Generator Logic
      const metaphorFrames = {
        curious: [
          "like a detective solving a mystery",
          "like an explorer discovering a hidden treasure",
          "like a scientist unlocking nature's secrets",
          "like a puzzle waiting to be solved"
        ],
        reflective: [
          "like a mirror reflecting deeper truths",
          "like a bridge connecting distant ideas",
          "like a lens that brings clarity to complexity",
          "like a key that opens new understanding"
        ],
        playful: [
          "like a game with hidden rules to discover",
          "like a magical transformation happening before your eyes",
          "like a dance between different forces",
          "like a recipe for creating something amazing"
        ]
      };

      const storySettings = [
        "In your everyday kitchen",
        "In a bustling city",
        "In the natural world around us",
        "In your favorite video game",
        "In a school cafeteria",
        "In your backyard",
        "In a laboratory",
        "In a library"
      ];

      const characters = [
        "curious students",
        "busy molecules",
        "determined atoms",
        "wise trees",
        "energetic electrons",
        "thoughtful historians",
        "creative artists",
        "problem-solving mathematicians"
      ];

      const reflectionStarters = {
        "6-8": [
          "What surprised you most about this idea?",
          "How does this connect to something you already know?",
          "If you had to explain this to a friend, what would you say?",
          "What questions does this make you want to ask?"
        ],
        "9-12": [
          "How might this concept apply to real-world problems?",
          "What assumptions are you making about this topic?",
          "How does this challenge or confirm what you thought before?",
          "What would happen if we changed one key element?"
        ],
        "college": [
          "What are the broader implications of this concept?",
          "How does this relate to current research or debates in the field?",
          "What would you investigate further if you had unlimited resources?",
          "How might this knowledge influence your future decisions?"
        ]
      };

      let currentSpark = '';

      function generateStorySpark() {
        const topic = document.getElementById('topic-input').value.trim();
        const tone = document.getElementById('tone-select').value;
        const grade = document.getElementById('grade-select').value;

        if (!topic) {
          alert('Please enter a topic or concept');
          return;
        }

        const output = document.getElementById('demo-output');
        const loader = document.getElementById('demo-loading');

        // Show the output container (so transitions feel natural) and show loader overlay
        output.classList.add('show');
        loader.classList.add('show');
        loader.setAttribute('aria-hidden', 'false');

        // Realistic generation time between 2000 and 3200 ms
        const generationDelay = 2000 + Math.floor(Math.random() * 1200);

        // Ensure the UI announces something for screen readers while loading
        document.getElementById('metaphor-output').textContent = '';
        document.getElementById('story-output').textContent = '';
        document.getElementById('prompts-output').textContent = '';

        // Disable the generate button briefly to prevent double clicks
        const genBtn = document.querySelector('.demo-button');
        genBtn.disabled = true;
        genBtn.setAttribute('aria-busy', 'true');

        setTimeout(async () => {
          // Pick a warm, human-flavored template based on keywords
          const template = generateTemplateForTopic(topic, tone, grade);

          // Hide loader and type the outputs like a helpful Muse assistant
          loader.classList.remove('show');
          loader.setAttribute('aria-hidden', 'true');

          const reduced = prefersReducedMotion();
          const baseSpeed = reduced ? 0 : (18 + Math.floor(Math.random() * 12)); // ms per char

          // Type metaphor, then story, then prompts with small pauses for realism
          await typeText(document.getElementById('metaphor-output'), template.metaphor, { speed: baseSpeed });
          await wait(220);
          await typeText(document.getElementById('story-output'), template.story, { speed: baseSpeed });
          await wait(300);
          // For prompts, join them into numbered lines
          const promptsText = template.prompts.map((p, i) => `${i + 1}. ${p}`).join('\n\n');
          await typeText(document.getElementById('prompts-output'), promptsText, { speed: baseSpeed });

          // Build currentSpark for clipboard/download
          currentSpark = `Story Spark: ${topic}\n\nMetaphor:\n${template.metaphor}\n\nMini-Story:\n${template.story}\n\nReflection Prompts:\n${template.prompts.map((p, i) => `${i+1}. ${p}`).join('\n')}`;

          // Re-enable button
          genBtn.disabled = false;
          genBtn.removeAttribute('aria-busy');

          // Smooth scroll the output into view once fully typed
          output.scrollIntoView({ behavior: reduced ? 'auto' : 'smooth', block: 'nearest' });
        }, generationDelay);
      }

      function getRandomItem(array) {
        return array[Math.floor(Math.random() * array.length)];
      }

      function getRandomItems(array, count) {
        const shuffled = [...array].sort(() => 0.5 - Math.random());
        return shuffled.slice(0, count);
      }

      // Small utility to pause
      function wait(ms) {
        return new Promise(resolve => setTimeout(resolve, ms));
      }

      function prefersReducedMotion() {
        try {
          return window.matchMedia('(prefers-reduced-motion: reduce)').matches;
        } catch (e) {
          return false;
        }
      }

      // Escape text for safe HTML insertion
      function escapeHtml(text) {
        const map = { '&': '&amp;', '<': '&lt;', '>': '&gt;', '"': '&quot;', "'": '&#039;' };
        return String(text).replace(/[&<>"']/g, function(m) { return map[m]; });
      }

      // Typing animation into an element. Options: speed (ms per char). If speed === 0, write instantly.
      function typeText(el, text, options = {}) {
        const speed = options.speed == null ? 20 : options.speed;
        // Ensure pre-wrap so line breaks show
        el.classList.add('typing');
        el.setAttribute('data-typed', '');

        if (!speed) {
          // Instant write
          el.innerHTML = escapeHtml(text).replace(/\n/g, '<br>');
          return Promise.resolve();
        }

        return new Promise(resolve => {
          let i = 0;
          const total = text.length;
          const cursorSpan = '<span class="cursor" aria-hidden="true"></span>';

          function step() {
            i++;
            const partial = escapeHtml(text.slice(0, i)).replace(/\n/g, '<br>');
            el.innerHTML = partial + cursorSpan;
            if (i < total) {
              // Variable speed to feel more human: small chance to pause slightly
              const jitter = Math.random() < 0.04 ? 120 + Math.random() * 220 : 0;
              setTimeout(step, speed + jitter);
            } else {
              // Done
              el.innerHTML = escapeHtml(text).replace(/\n/g, '<br>');
              resolve();
            }
          }

          // Start with a small delay to simulate thinking
          setTimeout(step, 120 + Math.random() * 120);
        });
      }

      // Choose a pre-written warm Muse-style template based on topic keywords
      function generateTemplateForTopic(topic, tone, grade) {
        const t = topic.toLowerCase();

        const historical = {
          metaphor: `${topic} is like a small spark that builds into a shared story ‚Äî a moment that changes how people see the world.`,
          story: `Imagine a classroom where your students step into the shoes of people who lived through ${topic}. One student becomes a messenger racing through town, another keeps a hidden diary. Together they discover that the "big event" was made of many small decisions, fear, hope, and ordinary choices. Through the story, the causes, consequences, and human costs become clear ‚Äî not as dates, but as lived experience that asks, "What would you have done?"`,
          prompts: [
            `Which character's choice surprised you ‚Äî and why might they have acted that way?`,
            `How did ordinary people shape the larger events of ${topic}?`,
            `If you could change one decision in this story, what might happen next?`
          ]
        };

        const science = {
          metaphor: `${topic} is like a quiet conversation under the surface ‚Äî small exchanges that together keep the world running.`,
          story: `Picture a tiny laboratory in a school where a curious student watches ${topic} through a magnifying lens. At first it seems mysterious, but as they tinker, test, and ask questions they begin to map the invisible rules that govern it. What seemed like magic becomes a pattern, and that pattern opens the door to experiments, failures, and surprising discoveries. This story invites students to try, observe, and wonder.`,
          prompts: [
            `What would you predict happens if we change one variable in this system?`,
            `Which evidence in the story convinced you, and why?`,
            `How could you test the idea in a simple hands-on experiment?`
          ]
        };

        const math = {
          metaphor: `${topic} is like a map to a hidden treasure ‚Äî the symbols and steps show the route, and each equation is a clue.`,
          story: `In this mini-story, a group of students find a mystery that can only be solved with ${topic}. At first the clues are confusing, but as they translate the clues into equations and diagrams, the path grows clearer. The process shows that math is less about right answers and more about strategies for making sense of puzzles ‚Äî a tool for curiosity and cleverness.`,
          prompts: [
            `Which step in the solution felt most like a creative move?`,
            `How would you explain this strategy to a friend who hates math?`,
            `Can you find a different path that leads to the same answer?`
          ]
        };

        const generic = {
          metaphor: `${topic} is like a friendly guide that helps you notice the unseen connections in everyday life.`,
          story: `Think of ${topic} as a story you carry with you. A student notices it in the world ‚Äî in a backyard, a bus ride, or a kitchen ‚Äî and that curiosity leads them to ask one small question. That question unfolds into a short exploration, some guesswork, and finally a clearer idea that they can share with others. The emphasis is on curiosity, failing forward, and the joy of understanding.`,
          prompts: [
            `What everyday example helped you understand this idea better?`,
            `Which part of the story would you expand into a longer activity?`,
            `What question would you ask next to learn more?`
          ]
        };

        // Keyword detection
        if (/history|revolution|war|empire|independence|colonial/.test(t)) return historical;
        if (/science|chemistry|biology|physics|photosynthesis|cells|reaction|molecule/.test(t)) return science;
        if (/math|algebra|geometry|equation|quadratic|calculus|trigonometry/.test(t)) return math;
        return generic;
      }

      function copyToClipboard(event) {
        const button = event && event.target ? event.target : null;
        navigator.clipboard.writeText(currentSpark).then(function() {
          if (button) {
            const originalText = button.textContent;
            button.textContent = 'Copied!';
            setTimeout(() => { button.textContent = originalText; }, 2000);
          }
        }).catch(function(err) {
          console.error('Could not copy text: ', err);
          // Fallback for older browsers
          const textArea = document.createElement('textarea');
          textArea.value = currentSpark;
          document.body.appendChild(textArea);
          textArea.select();
          document.execCommand('copy');
          document.body.removeChild(textArea);
          if (button) {
            const originalText = button.textContent;
            button.textContent = 'Copied!';
            setTimeout(() => { button.textContent = originalText; }, 2000);
          }
        });
      }

      function downloadSpark() {
        const blob = new Blob([currentSpark], { type: 'text/plain' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = 'story-spark.txt';
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        URL.revokeObjectURL(url);
      }

      // Accordion functionality
      function toggleAccordion(id) {
        const content = document.getElementById(id);
        const trigger = event.target;
        const isExpanded = content.classList.contains('expanded');
        
        if (isExpanded) {
          content.classList.remove('expanded');
          trigger.setAttribute('aria-expanded', 'false');
        } else {
          content.classList.add('expanded');
          trigger.setAttribute('aria-expanded', 'true');
        }
      }

      // Footer disclosure functionality
      function toggleDisclosure(id) {
        const disclosure = document.getElementById(id);
        const trigger = event.target;
        const isExpanded = disclosure.classList.contains('expanded');
        
        if (isExpanded) {
          disclosure.classList.remove('expanded');
          trigger.setAttribute('aria-expanded', 'false');
        } else {
          disclosure.classList.add('expanded');
          trigger.setAttribute('aria-expanded', 'true');
        }
      }

      // Download page functionality
      function downloadPage() {
        const htmlContent = document.documentElement.outerHTML;
        const blob = new Blob([htmlContent], { type: 'text/html' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = 'muse-educator-pilot.html';
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        URL.revokeObjectURL(url);
      }

      // Smooth scrolling for anchor links
      document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener('click', function (e) {
          e.preventDefault();
          const target = document.querySelector(this.getAttribute('href'));
          if (target) {
            target.scrollIntoView({
              behavior: 'smooth',
              block: 'start'
            });
          }
        });
      });

      // Enhanced keyboard navigation
      document.addEventListener('keydown', function(e) {
        // Enter key on demo button
        if (e.key === 'Enter' && e.target.classList.contains('demo-button')) {
          generateStorySpark();
        }
        
        // Escape key to close accordion/disclosure
        if (e.key === 'Escape') {
          document.querySelectorAll('.accordion-content.expanded, .disclosure.expanded').forEach(el => {
            el.classList.remove('expanded');
            const trigger = document.querySelector(`[aria-controls="${el.id}"]`);
            if (trigger) {
              trigger.setAttribute('aria-expanded', 'false');
            }
          });
        }
      });

      // Initialize demo with example on page load
      document.addEventListener('DOMContentLoaded', function() {
        document.getElementById('topic-input').value = 'Photosynthesis';
      });
    </script>
  </body>
</html>
